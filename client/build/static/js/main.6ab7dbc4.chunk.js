(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{21:function(e,t,n){e.exports=n(33)},26:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(19),l=n.n(c),o=(n(26),n(11)),u=n(1),s=n(7),i=n.n(s),d=n(8),b=n(6);function m(){console.log("____noop____")}var g=Object(a.createContext)({token:null,userId:null,login:m,logout:m,isAuthenticated:!1}),p=function(){var e=Object(a.useState)(!1),t=Object(b.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(null),l=Object(b.a)(c,2),o=l[0],u=l[1];return{loading:n,request:Object(a.useCallback)(function(){var e=Object(d.a)(i.a.mark((function e(t){var n,a,c,l,o,s=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:"GET",a=s.length>2&&void 0!==s[2]?s[2]:null,c=s.length>3&&void 0!==s[3]?s[3]:{},r(!0),e.prev=4,a&&(a=JSON.stringify(a),c["Content-Type"]="application/json"),e.next=8,fetch(t,{method:n,body:a,headers:c});case 8:return l=e.sent,e.next=11,l.json();case 11:if(o=e.sent,l.ok){e.next=14;break}throw new Error(o.message||"Error :: Backend connection");case 14:return r(!1),e.abrupt("return",o);case 18:throw e.prev=18,e.t0=e.catch(4),r(!1),u(e.t0.message),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:o,clearError:Object(a.useCallback)((function(){return u(null)}),[])}},f=function(){var e=Object(u.g)(),t=Object(a.useContext)(g),n=Object(a.useContext)(g),c=n.token,l=n.userId,o=Object(a.useState)([]),s=Object(b.a)(o,2),m=s[0],f=s[1],h=p(),v=(h.loading,h.request),E=(h.error,function(){var e=Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f([]),O();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),O=Object(a.useCallback)(Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("send"),e.prev=1,e.next=4,v("/api/articles?userId="+l,"GET",null,{Authorization:"Bearer ".concat(c)});case 4:t=e.sent,console.log("data",t),f(t.articles),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,null,[[1,9]])}))),[c,v]);return Object(a.useEffect)((function(){O()}),[O]),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){t.logout(),e.push("/")},style:{float:"right"}},"Logout"),r.a.createElement("h2",null,"ArticlesPage"),r.a.createElement("button",{onClick:E},"Refresh"),r.a.createElement("br",null),0==m.length&&"Loading...",m.length>0&&m.map((function(e,t){return r.a.createElement("p",{key:t},r.a.createElement("b",null,e.title),r.a.createElement("br",null)," ",e.text)})))},h=n(12),v=n(13),E=function(){var e=Object(a.useContext)(g),t=p(),n=(t.loading,t.request),c=(t.error,Object(a.useState)({login:"",password:""})),l=Object(b.a)(c,2),o=l[0],u=l[1],s=function(e){u(Object(v.a)(Object(v.a)({},o),{},Object(h.a)({},e.target.name,e.target.value)))},m=function(){var t=Object(d.a)(i.a.mark((function t(){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n("/api/signin","POST",Object(v.a)({},o));case 3:a=t.sent,e.login(a.token,a.userId),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("h2",null,"HomePage"),r.a.createElement("div",{className:"form-content"},r.a.createElement("div",null,r.a.createElement("label",null,"Login: "),r.a.createElement("input",{placeholder:"Login",id:"login",type:"text",name:"login",value:o.login,onChange:s})),r.a.createElement("div",null,r.a.createElement("label",null,"Password:"),r.a.createElement("input",{placeholder:"Password",id:"password",type:"password",name:"password",value:o.password,onChange:s})),r.a.createElement("button",{disabled:0==o.login.length||0==o.password.length,onClick:m},"sign in")))};var O=function(){var e=function(){var e=Object(a.useState)(null),t=Object(b.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),l=Object(b.a)(c,2),o=l[0],u=l[1],s=Object(a.useState)(null),i=Object(b.a)(s,2),d=i[0],m=i[1],g=Object(a.useCallback)((function(e,t){r(e),m(t),localStorage.setItem("userData",JSON.stringify({userId:t,token:e}))}),[]),p=Object(a.useCallback)((function(){r(null),m(null),localStorage.removeItem("userData")}),[]);return Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&g(e.token,e.userId),u(!0)}),[g]),{login:g,logout:p,token:n,userId:d,ready:o}}(),t=e.token,n=e.login,c=e.logout,l=e.userId,s=(e.ready,!!t),i=function(e){return e?r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/articles",exact:!0},r.a.createElement(f,null)),r.a.createElement(u.a,{to:"/articles"})):r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/",exact:!0},r.a.createElement(E,null)),r.a.createElement(u.a,{to:"/"}))}(s);return r.a.createElement(g.Provider,{value:{token:t,login:n,logout:c,userId:l,isAuthenticated:s}},r.a.createElement(o.a,null,r.a.createElement("div",{className:"container"},i)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.6ab7dbc4.chunk.js.map